
namespace: kubeclarity, deployment: kubeclarity-kubeclarity (kubernetes)
========================================================================
Tests: 106 (SUCCESSES: 90, FAILURES: 16, EXCEPTIONS: 0)
Failures: 16 (UNKNOWN: 0, LOW: 12, MEDIUM: 4, HIGH: 0, CRITICAL: 0)

LOW: Container 'kubeclarity' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:39-134
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - run
  41 │                     - --log-level
  42 │                     - warning
  43 │                   env:
  44 │                     - name: ENABLE_DB_INFO_LOGS
  45 │                       value: "false"
  46 │                     - name: DB_NAME
  47 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-grype-server' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:211-238
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 211 ┌                 - args:
 212 │                     - /bin/sh
 213 │                     - -c
 214 │                     - |
 215 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-grype-server:8080/healthz/ready" -o /dev/null) -ne 200 ]; do
 216 │                         echo waiting for grype-server to be ready; sleep 2;
 217 │                       done;
 218 │                   image: docker.io/curlimages/curl:7.87.0
 219 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-pg-db' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:137-182
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 137 ┌                 - command:
 138 │                     - sh
 139 │                     - -c
 140 │                     - until pg_isready -h "$DB_HOST" -p "$DB_PORT_NUMBER" -U "$DB_USER" -d "dbname=$DB_NAME"; do echo waiting for database; sleep 2; done;
 141 │                   env:
 142 │                     - name: DB_NAME
 143 │                       valueFrom:
 144 │                         secretKeyRef:
 145 └                             key: postgres-database
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-sbom-db' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:183-210
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 183 ┌                 - args:
 184 │                     - /bin/sh
 185 │                     - -c
 186 │                     - |
 187 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-sbom-db:8081/healthz/ready" -o /dev/null) -ne 200 ]; do
 188 │                         echo waiting for sbom database; sleep 2;
 189 │                       done;
 190 │                   image: docker.io/curlimages/curl:7.87.0
 191 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:39-134
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - run
  41 │                     - --log-level
  42 │                     - warning
  43 │                   env:
  44 │                     - name: ENABLE_DB_INFO_LOGS
  45 │                       value: "false"
  46 │                     - name: DB_NAME
  47 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-grype-server' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:211-238
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 211 ┌                 - args:
 212 │                     - /bin/sh
 213 │                     - -c
 214 │                     - |
 215 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-grype-server:8080/healthz/ready" -o /dev/null) -ne 200 ]; do
 216 │                         echo waiting for grype-server to be ready; sleep 2;
 217 │                       done;
 218 │                   image: docker.io/curlimages/curl:7.87.0
 219 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-pg-db' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:137-182
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 137 ┌                 - command:
 138 │                     - sh
 139 │                     - -c
 140 │                     - until pg_isready -h "$DB_HOST" -p "$DB_PORT_NUMBER" -U "$DB_USER" -d "dbname=$DB_NAME"; do echo waiting for database; sleep 2; done;
 141 │                   env:
 142 │                     - name: DB_NAME
 143 │                       valueFrom:
 144 │                         secretKeyRef:
 145 └                             key: postgres-database
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kubeclarity-kubeclarity-wait-for-sbom-db' of Deployment 'kubeclarity-kubeclarity' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:183-210
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 183 ┌                 - args:
 184 │                     - /bin/sh
 185 │                     - -c
 186 │                     - |
 187 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-sbom-db:8081/healthz/ready" -o /dev/null) -ne 200 ]; do
 188 │                         echo waiting for sbom database; sleep 2;
 189 │                       done;
 190 │                   image: docker.io/curlimages/curl:7.87.0
 191 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:39-134
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - run
  41 │                     - --log-level
  42 │                     - warning
  43 │                   env:
  44 │                     - name: ENABLE_DB_INFO_LOGS
  45 │                       value: "false"
  46 │                     - name: DB_NAME
  47 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:211-238
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 211 ┌                 - args:
 212 │                     - /bin/sh
 213 │                     - -c
 214 │                     - |
 215 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-grype-server:8080/healthz/ready" -o /dev/null) -ne 200 ]; do
 216 │                         echo waiting for grype-server to be ready; sleep 2;
 217 │                       done;
 218 │                   image: docker.io/curlimages/curl:7.87.0
 219 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:137-182
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 137 ┌                 - command:
 138 │                     - sh
 139 │                     - -c
 140 │                     - until pg_isready -h "$DB_HOST" -p "$DB_PORT_NUMBER" -U "$DB_USER" -d "dbname=$DB_NAME"; do echo waiting for database; sleep 2; done;
 141 │                   env:
 142 │                     - name: DB_NAME
 143 │                       valueFrom:
 144 │                         secretKeyRef:
 145 └                             key: postgres-database
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity:183-210
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 183 ┌                 - args:
 184 │                     - /bin/sh
 185 │                     - -c
 186 │                     - |
 187 │                       set -x; while [ $(curl -sw '%{http_code}' "http://kubeclarity-kubeclarity-sbom-db:8081/healthz/ready" -o /dev/null) -ne 200 ]; do
 188 │                         echo waiting for sbom database; sleep 2;
 189 │                       done;
 190 │                   image: docker.io/curlimages/curl:7.87.0
 191 └                   imagePullPolicy: IfNotPresent
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kubeclarity" of deployment "kubeclarity-kubeclarity" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kubeclarity-kubeclarity-wait-for-grype-server" of deployment "kubeclarity-kubeclarity" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kubeclarity-kubeclarity-wait-for-pg-db" of deployment "kubeclarity-kubeclarity" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kubeclarity-kubeclarity-wait-for-sbom-db" of deployment "kubeclarity-kubeclarity" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kubeclarity, deployment: kubeclarity-kubeclarity-grype-server (kubernetes)
=====================================================================================
Tests: 94 (SUCCESSES: 90, FAILURES: 4, EXCEPTIONS: 0)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

LOW: Container 'grype-server' of Deployment 'kubeclarity-kubeclarity-grype-server' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-grype-server:38-88
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   env:
  43 │                     - name: DB_ROOT_DIR
  44 │                       value: /tmp/
  45 │                   image: ghcr.io/openclarity/grype-server:v0.6.0
  46 └                   imagePullPolicy: Always
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'grype-server' of Deployment 'kubeclarity-kubeclarity-grype-server' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-grype-server:38-88
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   env:
  43 │                     - name: DB_ROOT_DIR
  44 │                       value: /tmp/
  45 │                   image: ghcr.io/openclarity/grype-server:v0.6.0
  46 └                   imagePullPolicy: Always
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-grype-server:38-88
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   env:
  43 │                     - name: DB_ROOT_DIR
  44 │                       value: /tmp/
  45 │                   image: ghcr.io/openclarity/grype-server:v0.6.0
  46 └                   imagePullPolicy: Always
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "grype-server" of deployment "kubeclarity-kubeclarity-grype-server" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kubeclarity, deployment: kubeclarity-kubeclarity-sbom-db (kubernetes)
================================================================================
Tests: 94 (SUCCESSES: 90, FAILURES: 4, EXCEPTIONS: 0)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

LOW: Container 'sbom-db' of Deployment 'kubeclarity-kubeclarity-sbom-db' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-sbom-db:38-85
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   image: ghcr.io/openclarity/kubeclarity-sbom-db:v2.23.3
  43 │                   imagePullPolicy: Always
  44 │                   livenessProbe:
  45 │                     failureThreshold: 5
  46 └                     httpGet:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'sbom-db' of Deployment 'kubeclarity-kubeclarity-sbom-db' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-sbom-db:38-85
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   image: ghcr.io/openclarity/kubeclarity-sbom-db:v2.23.3
  43 │                   imagePullPolicy: Always
  44 │                   livenessProbe:
  45 │                     failureThreshold: 5
  46 └                     httpGet:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, deployment: kubeclarity-kubeclarity-sbom-db:38-85
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  38 ┌                 - args:
  39 │                     - run
  40 │                     - --log-level
  41 │                     - warning
  42 │                   image: ghcr.io/openclarity/kubeclarity-sbom-db:v2.23.3
  43 │                   imagePullPolicy: Always
  44 │                   livenessProbe:
  45 │                     failureThreshold: 5
  46 └                     httpGet:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "sbom-db" of deployment "kubeclarity-kubeclarity-sbom-db" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: local-path-storage, deployment: local-path-provisioner (kubernetes)
==============================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'local-path-provisioner' of Deployment 'local-path-provisioner' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "local-path-provisioner" of deployment "local-path-provisioner" in "local-path-storage" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: local-path-storage, deployment: local-path-provisioner:18-36
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌                 - command:
  19 │                     - local-path-provisioner
  20 │                     - --debug
  21 │                     - start
  22 │                     - --helper-image
  23 │                     - docker.io/kindest/local-path-helper:v20230510-486859a6
  24 │                     - --config
  25 │                     - /etc/config/config.json
  26 └                   env:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-ad-service (kubernetes)
===============================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'ad-service' of Deployment 'unguard-ad-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "ad-service" of deployment "unguard-ad-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-ad-service:36-63
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Production
  39 │                     - name: SERVER_PORT
  40 │                       value: "8082"
  41 │                     - name: API_PATH
  42 │                       value: /ad-service
  43 │                     - name: USER_AUTH_SERVICE_ADDRESS
  44 └                       value: unguard-user-auth-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-envoy-proxy (kubernetes)
================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'envoy-proxy' of Deployment 'unguard-envoy-proxy' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "envoy-proxy" of deployment "unguard-envoy-proxy" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-envoy-proxy:39-51
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - image: ghcr.io/dynatrace-oss/unguard/unguard-envoy-proxy:0.9.3
  40 │                   imagePullPolicy: IfNotPresent
  41 │                   name: envoy-proxy
  42 │                   ports:
  43 │                     - containerPort: 8080
  44 │                       name: http
  45 │                       protocol: TCP
  46 │                     - containerPort: 8081
  47 └                       name: health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-frontend (kubernetes)
=============================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'frontend' of Deployment 'unguard-frontend' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'frontend' of Deployment 'unguard-frontend' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'frontend' of Deployment 'unguard-frontend' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'unguard-frontend' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "frontend" of deployment "unguard-frontend" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-frontend:36-81
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: MICROBLOG_SERVICE_ADDRESS
  38 │                       value: unguard-microblog-service
  39 │                     - name: PROXY_SERVICE_ADDRESS
  40 │                       value: unguard-proxy-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: AD_SERVICE_ADDRESS
  44 └                       value: unguard-ad-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-like-service (kubernetes)
=================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'like-service' of Deployment 'unguard-like-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'like-service' of Deployment 'unguard-like-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'like-service' of Deployment 'unguard-like-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'like-service' of Deployment 'unguard-like-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "like-service" of deployment "unguard-like-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-like-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8000"
  39 │                     - name: API_PATH
  40 │                       value: /like-service
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: MARIADB_PASSWORD
  44 └                       valueFrom:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-membership-service (kubernetes)
=======================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'membership-service' of Deployment 'unguard-membership-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "membership-service" of deployment "unguard-membership-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-membership-service:36-58
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: ASPNETCORE_ENVIRONMENT
  38 │                       value: Development
  39 │                     - name: SERVER_PORT
  40 │                       value: "8083"
  41 │                     - name: API_PATH
  42 │                       value: /membership-service
  43 │                     - name: MARIADB_SERVICE
  44 └                       value: unguard-mariadb
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-microblog-service (kubernetes)
======================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'microblog-service' of Deployment 'unguard-microblog-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "microblog-service" of deployment "unguard-microblog-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-microblog-service:36-61
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8080"
  39 │                     - name: REDIS_SERVICE_ADDRESS
  40 │                       value: unguard-redis
  41 │                     - name: USER_AUTH_SERVICE_ADDRESS
  42 │                       value: unguard-user-auth-service
  43 │                     - name: OPENTRACING_JAEGER_ENABLED
  44 └                       value: "false"
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-payment-service (kubernetes)
====================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'payment-service' of Deployment 'unguard-payment-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "payment-service" of deployment "unguard-payment-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-payment-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8084"
  39 │                     - name: API_PATH
  40 │                       value: /payment-service
  41 │                     - name: OTEL_LOGS_EXPORTER
  42 │                       value: none
  43 │                     - name: OTEL_METRICS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-profile-service (kubernetes)
====================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'profile-service' of Deployment 'unguard-profile-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "profile-service" of deployment "unguard-profile-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-profile-service:36-69
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SPRING_DATASOURCE_URL
  38 │                       value: jdbc:h2:file:./database/bio
  39 │                     - name: SPRING_DATASOURCE_USERNAME
  40 │                       value: sa
  41 │                     - name: SPRING_DATASOURCE_PASSWORD
  42 │                       value: password
  43 │                     - name: OTEL_LOGS_EXPORTER
  44 └                       value: none
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-proxy-service (kubernetes)
==================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'proxy-service' of Deployment 'unguard-proxy-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "proxy-service" of deployment "unguard-proxy-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-proxy-service:36-57
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8081"
  39 │                     - name: OPENTRACING_JAEGER_ENABLED
  40 │                       value: "false"
  41 │                     - name: JAEGER_SERVICE_NAME
  42 │                       value: unguard-proxy-service
  43 │                     - name: JAEGER_AGENT_HOST
  44 └                       value: jaeger-agent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-redis (kubernetes)
==========================================================
Tests: 94 (SUCCESSES: 85, FAILURES: 9, EXCEPTIONS: 0)
Failures: 9 (UNKNOWN: 0, LOW: 5, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'redis' of Deployment 'unguard-redis' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'redis' of Deployment 'unguard-redis' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'redis' of Deployment 'unguard-redis' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'redis' of Deployment 'unguard-redis' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'redis' of Deployment 'unguard-redis' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'redis' of Deployment 'unguard-redis' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "redis" of deployment "unguard-redis" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-redis:36-75
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - command:
  37 │                     - redis-server
  38 │                     - /config/redis.conf
  39 │                   env:
  40 │                     - name: MASTER
  41 │                       value: "true"
  42 │                   image: redis:5.0
  43 │                   imagePullPolicy: IfNotPresent
  44 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-status-service (kubernetes)
===================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'status-service' of Deployment 'unguard-status-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'status-service' of Deployment 'unguard-status-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'status-service' of Deployment 'unguard-status-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'status-service' of Deployment 'unguard-status-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "status-service" of deployment "unguard-status-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-status-service:36-60
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "8083"
  39 │                     - name: API_PATH
  40 │                       value: /status-service
  41 │                     - name: KUBERNETES_NAMESPACE
  42 │                       value: unguard
  43 │                     - name: IGNORED_DEPLOYMENTS
  44 └                       value: unguard-user-simulator
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, deployment: unguard-user-auth-service (kubernetes)
======================================================================
Tests: 94 (SUCCESSES: 81, FAILURES: 13, EXCEPTIONS: 0)
Failures: 13 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'user-auth-service' of Deployment 'unguard-user-auth-service' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "user-auth-service" of deployment "unguard-user-auth-service" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, deployment: unguard-user-auth-service:36-64
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  36 ┌                 - env:
  37 │                     - name: SERVER_PORT
  38 │                       value: "9091"
  39 │                     - name: MARIADB_SERVICE
  40 │                       value: unguard-mariadb
  41 │                     - name: MARIADB_PASSWORD
  42 │                       valueFrom:
  43 │                         secretKeyRef:
  44 └                             key: mariadb-root-password
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql (kubernetes)
====================================================================================
Tests: 94 (SUCCESSES: 83, FAILURES: 11, EXCEPTIONS: 0)
Failures: 11 (UNKNOWN: 0, LOW: 7, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'postgresql' of StatefulSet 'kubeclarity-kubeclarity-postgresql' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "postgresql" of statefulset "kubeclarity-kubeclarity-postgresql" in "kubeclarity" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kubeclarity, statefulset: kubeclarity-kubeclarity-postgresql:57-133
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  57 ┌                 - env:
  58 │                     - name: BITNAMI_DEBUG
  59 │                       value: "false"
  60 │                     - name: POSTGRESQL_PORT_NUMBER
  61 │                       value: "5432"
  62 │                     - name: POSTGRESQL_VOLUME_DIR
  63 │                       value: /bitnami/postgresql
  64 │                     - name: PGDATA
  65 └                       value: /bitnami/postgresql/data
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, statefulset: unguard-mariadb (kubernetes)
=============================================================
Tests: 94 (SUCCESSES: 83, FAILURES: 11, EXCEPTIONS: 0)
Failures: 11 (UNKNOWN: 0, LOW: 9, MEDIUM: 1, HIGH: 1, CRITICAL: 0)

LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mariadb' of StatefulSet 'unguard-mariadb' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "mariadb" of statefulset "unguard-mariadb" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, statefulset: unguard-mariadb:56-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  56 ┌                 - env:
  57 │                     - name: BITNAMI_DEBUG
  58 │                       value: "false"
  59 │                     - name: MARIADB_ROOT_PASSWORD
  60 │                       valueFrom:
  61 │                         secretKeyRef:
  62 │                             key: mariadb-root-password
  63 │                             name: unguard-mariadb
  64 └                     - name: MARIADB_DATABASE
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: gadget, daemonset: gadget (kubernetes)
=================================================
Tests: 94 (SUCCESSES: 76, FAILURES: 18, EXCEPTIONS: 0)
Failures: 18 (UNKNOWN: 0, LOW: 9, MEDIUM: 6, HIGH: 3, CRITICAL: 0)

MEDIUM: Container 'gadget' of DaemonSet 'gadget' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should specify an AppArmor profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.

See https://avd.aquasec.com/misconfig/ksv002
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'gadget' of DaemonSet 'gadget' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'gadget' of DaemonSet 'gadget' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'gadget' of DaemonSet 'gadget' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'gadget' of DaemonSet 'gadget' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'gadget' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:15-205
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  15 ┌     revisionHistoryLimit: 10
  16 │     selector:
  17 │         matchLabels:
  18 │             k8s-app: gadget
  19 │     template:
  20 │         metadata:
  21 │             annotations:
  22 │                 container.apparmor.security.beta.kubernetes.io/gadget: unconfined
  23 └                 inspektor-gadget.kinvolk.io/option-hook-mode: auto
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'gadget' uses invalid seLinux type 'spc_t'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'SElinux', setting custom SELinux options should be disallowed.

See https://avd.aquasec.com/misconfig/ksv025
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:15-205
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  15 ┌     revisionHistoryLimit: 10
  16 │     selector:
  17 │         matchLabels:
  18 │             k8s-app: gadget
  19 │     template:
  20 │         metadata:
  21 │             annotations:
  22 │                 container.apparmor.security.beta.kubernetes.io/gadget: unconfined
  23 └                 inspektor-gadget.kinvolk.io/option-hook-mode: auto
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:33-139
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  33 ┌                 - command:
  34 │                     - /entrypoint
  35 │                   env:
  36 │                     - name: NODE_NAME
  37 │                       valueFrom:
  38 │                         fieldRef:
  39 │                             apiVersion: v1
  40 │                             fieldPath: spec.nodeName
  41 └                     - name: GADGET_POD_UID
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "gadget" of daemonset "gadget" in "gadget" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should not add stuff
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:91-100
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  91 ┌                         add:
  92 │                             - SYS_ADMIN
  93 │                             - SYSLOG
  94 │                             - SYS_PTRACE
  95 │                             - SYS_RESOURCE
  96 │                             - IPC_LOCK
  97 │                             - NET_RAW
  98 │                             - NET_ADMIN
  99 │                         drop:
 100 └                             - ALL
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container gadget of daemonset gadget in gadget namespace should not include 'NET_RAW' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: daemonset gadget in gadget namespace shouldn't have volumes set to {"/etc", "/proc", "/usr"}
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.

See https://avd.aquasec.com/misconfig/ksv121
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: gadget, daemonset: gadget:15-205
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  15 ┌     revisionHistoryLimit: 10
  16 │     selector:
  17 │         matchLabels:
  18 │             k8s-app: gadget
  19 │     template:
  20 │         metadata:
  21 │             annotations:
  22 │                 container.apparmor.security.beta.kubernetes.io/gadget: unconfined
  23 └                 inspektor-gadget.kinvolk.io/option-hook-mode: auto
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: unguard, cronjob: unguard-user-simulator (kubernetes)
================================================================
Tests: 94 (SUCCESSES: 85, FAILURES: 9, EXCEPTIONS: 0)
Failures: 9 (UNKNOWN: 0, LOW: 5, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'unguard-user-simulator' of CronJob 'unguard-user-simulator' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "unguard-user-simulator" of cronjob "unguard-user-simulator" in "unguard" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: unguard, cronjob: unguard-user-simulator:29-45
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  29 ┌                         - env:
  30 │                             - name: FRONTEND_ADDR
  31 │                               value: unguard-envoy-proxy:8080/ui
  32 │                             - name: SIMULATE_PRIVATE_RANGES
  33 │                               value: "false"
  34 │                           image: ghcr.io/dynatrace-oss/unguard/unguard-user-simulator:0.9.3
  35 │                           imagePullPolicy: IfNotPresent
  36 │                           name: unguard-user-simulator
  37 └                           resources:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: ingress-nginx, deployment: ingress-nginx-controller (kubernetes)
===========================================================================
Tests: 94 (SUCCESSES: 87, FAILURES: 7, EXCEPTIONS: 0)
Failures: 7 (UNKNOWN: 0, LOW: 4, MEDIUM: 1, HIGH: 2, CRITICAL: 0)

LOW: Container 'controller' of Deployment 'ingress-nginx-controller' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'controller' of Deployment 'ingress-nginx-controller' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'controller' of Deployment 'ingress-nginx-controller' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'controller' of Deployment 'ingress-nginx-controller' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'controller' of Deployment 'ingress-nginx-controller' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'controller' of Deployment 'ingress-nginx-controller' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: ingress-nginx, deployment: ingress-nginx-controller:49-124
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - /nginx-ingress-controller
  51 │                     - --publish-service=$(POD_NAMESPACE)/ingress-nginx-controller
  52 │                     - --election-id=ingress-nginx-leader
  53 │                     - --controller-class=k8s.io/ingress-nginx
  54 │                     - --ingress-class=nginx
  55 │                     - --configmap=$(POD_NAMESPACE)/ingress-nginx-controller
  56 │                   env:
  57 └                     - name: POD_NAME
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: deployment ingress-nginx-controller in ingress-nginx namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.

See https://avd.aquasec.com/misconfig/ksv117
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, deployment: cilium-operator (kubernetes)
================================================================
Tests: 94 (SUCCESSES: 78, FAILURES: 16, EXCEPTIONS: 0)
Failures: 16 (UNKNOWN: 0, LOW: 9, MEDIUM: 4, HIGH: 3, CRITICAL: 0)

MEDIUM: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Deployment 'cilium-operator' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:21-134
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     progressDeadlineSeconds: 600
  22 │     replicas: 2
  23 │     revisionHistoryLimit: 10
  24 │     selector:
  25 │         matchLabels:
  26 │             io.cilium/app: operator
  27 │             name: cilium-operator
  28 │     strategy:
  29 └         rollingUpdate:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-operator' of Deployment 'cilium-operator' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-operator' of Deployment 'cilium-operator' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Deployment 'cilium-operator' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:21-134
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     progressDeadlineSeconds: 600
  22 │     replicas: 2
  23 │     revisionHistoryLimit: 10
  24 │     selector:
  25 │         matchLabels:
  26 │             io.cilium/app: operator
  27 │             name: cilium-operator
  28 │     strategy:
  29 └         rollingUpdate:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "cilium-operator" of deployment "cilium-operator" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: cilium-operator:55-116
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  55 ┌                 - args:
  56 │                     - --config-dir=/tmp/cilium/config-map
  57 │                     - --debug=$(CILIUM_DEBUG)
  58 │                   command:
  59 │                     - cilium-operator-generic
  60 │                   env:
  61 │                     - name: K8S_NODE_NAME
  62 │                       valueFrom:
  63 └                         fieldRef:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, deployment: tetragon-operator (kubernetes)
==================================================================
Tests: 94 (SUCCESSES: 87, FAILURES: 7, EXCEPTIONS: 0)
Failures: 7 (UNKNOWN: 0, LOW: 3, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'tetragon-operator' of Deployment 'tetragon-operator' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:44-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  44 ┌                 - args:
  45 │                     - serve
  46 │                     - --config-dir=/etc/tetragon/operator.conf.d/
  47 │                     - --metrics-bind-address=:2113
  48 │                   command:
  49 │                     - /usr/bin/tetragon-operator
  50 │                   image: quay.io/cilium/tetragon-operator:v1.1.2
  51 │                   imagePullPolicy: IfNotPresent
  52 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'tetragon-operator' of Deployment 'tetragon-operator' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:44-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  44 ┌                 - args:
  45 │                     - serve
  46 │                     - --config-dir=/etc/tetragon/operator.conf.d/
  47 │                     - --metrics-bind-address=:2113
  48 │                   command:
  49 │                     - /usr/bin/tetragon-operator
  50 │                   image: quay.io/cilium/tetragon-operator:v1.1.2
  51 │                   imagePullPolicy: IfNotPresent
  52 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon-operator' of Deployment 'tetragon-operator' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:44-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  44 ┌                 - args:
  45 │                     - serve
  46 │                     - --config-dir=/etc/tetragon/operator.conf.d/
  47 │                     - --metrics-bind-address=:2113
  48 │                   command:
  49 │                     - /usr/bin/tetragon-operator
  50 │                   image: quay.io/cilium/tetragon-operator:v1.1.2
  51 │                   imagePullPolicy: IfNotPresent
  52 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon-operator' of Deployment 'tetragon-operator' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:44-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  44 ┌                 - args:
  45 │                     - serve
  46 │                     - --config-dir=/etc/tetragon/operator.conf.d/
  47 │                     - --metrics-bind-address=:2113
  48 │                   command:
  49 │                     - /usr/bin/tetragon-operator
  50 │                   image: quay.io/cilium/tetragon-operator:v1.1.2
  51 │                   imagePullPolicy: IfNotPresent
  52 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:44-94
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  44 ┌                 - args:
  45 │                     - serve
  46 │                     - --config-dir=/etc/tetragon/operator.conf.d/
  47 │                     - --metrics-bind-address=:2113
  48 │                   command:
  49 │                     - /usr/bin/tetragon-operator
  50 │                   image: quay.io/cilium/tetragon-operator:v1.1.2
  51 │                   imagePullPolicy: IfNotPresent
  52 └                   livenessProbe:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Deployment 'tetragon-operator' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: tetragon-operator:21-108
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     progressDeadlineSeconds: 600
  22 │     replicas: 1
  23 │     revisionHistoryLimit: 10
  24 │     selector:
  25 │         matchLabels:
  26 │             app.kubernetes.io/instance: tetragon
  27 │             app.kubernetes.io/name: tetragon-operator
  28 │     strategy:
  29 └         rollingUpdate:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "tetragon-operator" of deployment "tetragon-operator" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, pod: etcd-kind-control-plane (kubernetes)
=================================================================
Tests: 94 (SUCCESSES: 82, FAILURES: 12, EXCEPTIONS: 0)
Failures: 12 (UNKNOWN: 0, LOW: 6, MEDIUM: 4, HIGH: 2, CRITICAL: 0)

MEDIUM: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'etcd' of Pod 'etcd-kind-control-plane' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Pod 'etcd-kind-control-plane' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:25-107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌     containers:
  26 │         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 └             - --experimental-watch-progress-notify-interval=5s
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'etcd' of Pod 'etcd-kind-control-plane' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Pod 'etcd-kind-control-plane' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:25-107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌     containers:
  26 │         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 └             - --experimental-watch-progress-notify-interval=5s
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "etcd" of pod "etcd-kind-control-plane" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: etcd-kind-control-plane:26-82
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - etcd
  28 │             - --advertise-client-urls=https://172.18.0.2:2379
  29 │             - --cert-file=/etc/kubernetes/pki/etcd/server.crt
  30 │             - --client-cert-auth=true
  31 │             - --data-dir=/var/lib/etcd
  32 │             - --experimental-initial-corrupt-check=true
  33 │             - --experimental-watch-progress-notify-interval=5s
  34 └             - --initial-advertise-peer-urls=https://172.18.0.2:2380
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, pod: kube-apiserver-kind-control-plane (kubernetes)
===========================================================================
Tests: 94 (SUCCESSES: 72, FAILURES: 22, EXCEPTIONS: 0)
Failures: 22 (UNKNOWN: 0, LOW: 15, MEDIUM: 5, HIGH: 2, CRITICAL: 0)

MEDIUM: Ensure that the --anonymous-auth argument is set to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Disable anonymous requests to the API server.

See https://avd.aquasec.com/misconfig/kcv0001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --kubelet-certificate-authority argument is set as appropriate
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Verify kubelet's certificate before establishing connection.

See https://avd.aquasec.com/misconfig/kcv0006
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the admission control plugin EventRateLimit is set
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Limit the rate at which the API server accepts requests.

See https://avd.aquasec.com/misconfig/kcv0010
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the admission control plugin AlwaysPullImages is set
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Always pull images.

See https://avd.aquasec.com/misconfig/ksv0012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the admission control plugin SecurityContextDeny is set if PodSecurityPolicy is not used
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The SecurityContextDeny admission controller can be used to deny pods which make use of some SecurityContext fields which could allow for privilege escalation in the cluster. This should be used where PodSecurityPolicy is not in place within the cluster.

See https://avd.aquasec.com/misconfig/kcv0013
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --profiling argument is set to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Disable profiling, if not needed.

See https://avd.aquasec.com/misconfig/kcv0018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --audit-log-maxage argument is set to 30 or as appropriate
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Retain the logs for at least 30 days or as appropriate.

See https://avd.aquasec.com/misconfig/kcv0020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --audit-log-maxbackup argument is set to 10 or as appropriate
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Retain 10 or an appropriate number of old log files.

See https://avd.aquasec.com/misconfig/kcv0021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --audit-log-maxsize argument is set to 100 or as appropriate
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Rotate log files on reaching 100 MB or as appropriate.

See https://avd.aquasec.com/misconfig/kcv0022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Pod 'kube-apiserver-kind-control-plane' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:25-163
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌     containers:
  26 │         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 └             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-apiserver' of Pod 'kube-apiserver-kind-control-plane' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Pod 'kube-apiserver-kind-control-plane' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:25-163
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌     containers:
  26 │         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 └             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kube-apiserver" of pod "kube-apiserver-kind-control-plane" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-apiserver-kind-control-plane:26-118
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  26 ┌         - command:
  27 │             - kube-apiserver
  28 │             - --advertise-address=172.18.0.2
  29 │             - --allow-privileged=true
  30 │             - --audit-log-path=/var/log/kubernetes/kube-apiserver-audit.log
  31 │             - --audit-policy-file=/etc/kubernetes/policies/audit-policy.yaml
  32 │             - --authorization-mode=Node,RBAC
  33 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  34 └             - --enable-admission-plugins=NodeRestriction
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, pod: kube-controller-manager-kind-control-plane (kubernetes)
====================================================================================
Tests: 94 (SUCCESSES: 78, FAILURES: 16, EXCEPTIONS: 0)
Failures: 16 (UNKNOWN: 0, LOW: 10, MEDIUM: 4, HIGH: 2, CRITICAL: 0)

LOW: Ensure that the --terminated-pod-gc-threshold argument is set as appropriate
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Activate garbage collector on pod termination, as appropriate.

See https://avd.aquasec.com/misconfig/kcv0033
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the --profiling argument is set to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Disable profiling, if not needed.

See https://avd.aquasec.com/misconfig/kcv0034
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the RotateKubeletServerCertificate argument is set to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enable kubelet server certificate rotation on controller-manager.

See https://avd.aquasec.com/misconfig/kcv0038
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Pod 'kube-controller-manager-kind-control-plane' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:24-140
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  24 ┌     containers:
  25 │         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 └             - --cluster-cidr=10.244.0.0/16
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-controller-manager' of Pod 'kube-controller-manager-kind-control-plane' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Pod 'kube-controller-manager-kind-control-plane' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:24-140
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  24 ┌     containers:
  25 │         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 └             - --cluster-cidr=10.244.0.0/16
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kube-controller-manager" of pod "kube-controller-manager-kind-control-plane" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-controller-manager-kind-control-plane:25-95
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-controller-manager
  27 │             - --allocate-node-cidrs=true
  28 │             - --authentication-kubeconfig=/etc/kubernetes/controller-manager.conf
  29 │             - --authorization-kubeconfig=/etc/kubernetes/controller-manager.conf
  30 │             - --bind-address=127.0.0.1
  31 │             - --client-ca-file=/etc/kubernetes/pki/ca.crt
  32 │             - --cluster-cidr=10.244.0.0/16
  33 └             - --cluster-name=kind
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, pod: kube-scheduler-kind-control-plane (kubernetes)
===========================================================================
Tests: 94 (SUCCESSES: 80, FAILURES: 14, EXCEPTIONS: 0)
Failures: 14 (UNKNOWN: 0, LOW: 8, MEDIUM: 4, HIGH: 2, CRITICAL: 0)

LOW: Ensure that the --profiling argument is set to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Disable profiling, if not needed.

See https://avd.aquasec.com/misconfig/kcv0040
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Pod 'kube-scheduler-kind-control-plane' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:24-86
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  24 ┌     containers:
  25 │         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 └           image: registry.k8s.io/kube-scheduler:v1.30.0
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'kube-scheduler' of Pod 'kube-scheduler-kind-control-plane' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Pod 'kube-scheduler-kind-control-plane' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:24-86
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  24 ┌     containers:
  25 │         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 └           image: registry.k8s.io/kube-scheduler:v1.30.0
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "kube-scheduler" of pod "kube-scheduler-kind-control-plane" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, pod: kube-scheduler-kind-control-plane:25-65
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  25 ┌         - command:
  26 │             - kube-scheduler
  27 │             - --authentication-kubeconfig=/etc/kubernetes/scheduler.conf
  28 │             - --authorization-kubeconfig=/etc/kubernetes/scheduler.conf
  29 │             - --bind-address=127.0.0.1
  30 │             - --kubeconfig=/etc/kubernetes/scheduler.conf
  31 │             - --leader-elect=true
  32 │           image: registry.k8s.io/kube-scheduler:v1.30.0
  33 └           imagePullPolicy: IfNotPresent
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, deployment: coredns (kubernetes)
========================================================
Tests: 94 (SUCCESSES: 85, FAILURES: 9, EXCEPTIONS: 0)
Failures: 9 (UNKNOWN: 0, LOW: 4, MEDIUM: 4, HIGH: 1, CRITICAL: 0)

LOW: Container 'coredns' of Deployment 'coredns' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'coredns' of Deployment 'coredns' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'coredns' of Deployment 'coredns' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'coredns' of Deployment 'coredns' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'coredns' of Deployment 'coredns' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:45-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  45 ┌                 - args:
  46 │                     - -conf
  47 │                     - /etc/coredns/Corefile
  48 │                   image: registry.k8s.io/coredns/coredns:v1.11.1
  49 │                   imagePullPolicy: IfNotPresent
  50 │                   livenessProbe:
  51 │                     failureThreshold: 5
  52 │                     httpGet:
  53 └                         path: /health
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Deployment 'coredns' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: coredns:15-122
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  15 ┌     progressDeadlineSeconds: 600
  16 │     replicas: 2
  17 │     revisionHistoryLimit: 10
  18 │     selector:
  19 │         matchLabels:
  20 │             k8s-app: kube-dns
  21 │     strategy:
  22 │         rollingUpdate:
  23 └             maxSurge: 25%
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "coredns" of deployment "coredns" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: deployment coredns in kube-system namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.

See https://avd.aquasec.com/misconfig/ksv117
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, daemonset: tetragon (kubernetes)
========================================================
Tests: 107 (SUCCESSES: 77, FAILURES: 30, EXCEPTIONS: 0)
Failures: 30 (UNKNOWN: 0, LOW: 18, MEDIUM: 8, HIGH: 4, CRITICAL: 0)

MEDIUM: Container 'export-stdout' of DaemonSet 'tetragon' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: DaemonSet 'tetragon' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:21-125
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     revisionHistoryLimit: 10
  22 │     selector:
  23 │         matchLabels:
  24 │             app.kubernetes.io/instance: tetragon
  25 │             app.kubernetes.io/name: tetragon
  26 │     template:
  27 │         metadata:
  28 │             annotations:
  29 └                 checksum/configmap: 199fa351a7ceb5300ce37ec6be68b701309bab393c0986122e4f3a2446fb168b
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'export-stdout' of DaemonSet 'tetragon' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'export-stdout' of DaemonSet 'tetragon' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.privileged' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.

See https://avd.aquasec.com/misconfig/ksv017
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'export-stdout' of DaemonSet 'tetragon' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'tetragon' of DaemonSet 'tetragon' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'tetragon' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:21-125
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     revisionHistoryLimit: 10
  22 │     selector:
  23 │         matchLabels:
  24 │             app.kubernetes.io/instance: tetragon
  25 │             app.kubernetes.io/name: tetragon
  26 │     template:
  27 │         metadata:
  28 │             annotations:
  29 └                 checksum/configmap: 199fa351a7ceb5300ce37ec6be68b701309bab393c0986122e4f3a2446fb168b
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'tetragon' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:21-125
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  21 ┌     revisionHistoryLimit: 10
  22 │     selector:
  23 │         matchLabels:
  24 │             app.kubernetes.io/instance: tetragon
  25 │             app.kubernetes.io/name: tetragon
  26 │     template:
  27 │         metadata:
  28 │             annotations:
  29 └                 checksum/configmap: 199fa351a7ceb5300ce37ec6be68b701309bab393c0986122e4f3a2446fb168b
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "export-stdout" of daemonset "tetragon" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "tetragon" of daemonset "tetragon" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:53-89
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  53 ┌                 - args:
  54 │                     - --config-dir=/etc/tetragon/tetragon.conf.d/
  55 │                   env:
  56 │                     - name: NODE_NAME
  57 │                       valueFrom:
  58 │                         fieldRef:
  59 │                             apiVersion: v1
  60 │                             fieldPath: spec.nodeName
  61 └                   image: quay.io/cilium/tetragon:v1.1.2
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: tetragon:39-52
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  39 ┌                 - args:
  40 │                     - /var/run/cilium/tetragon/tetragon.log
  41 │                   command:
  42 │                     - hubble-export-stdout
  43 │                   image: quay.io/cilium/hubble-export-stdout:v1.0.4
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   name: export-stdout
  46 │                   resources: {}
  47 └                   securityContext: {}
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: cilium-agent (kubernetes)
==========================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'cilium-agent' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: cilium-agent:20-35
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     clusterIP: None
  21 │     clusterIPs:
  22 │         - None
  23 │     internalTrafficPolicy: Cluster
  24 │     ipFamilies:
  25 │         - IPv4
  26 │     ipFamilyPolicy: SingleStack
  27 │     ports:
  28 └         - name: envoy-metrics
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: hubble-metrics (kubernetes)
============================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'hubble-metrics' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: hubble-metrics:20-35
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     clusterIP: None
  21 │     clusterIPs:
  22 │         - None
  23 │     internalTrafficPolicy: Cluster
  24 │     ipFamilies:
  25 │         - IPv4
  26 │     ipFamilyPolicy: SingleStack
  27 │     ports:
  28 └         - name: hubble-metrics
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: hubble-peer (kubernetes)
=========================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'hubble-peer' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: hubble-peer:18-33
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌     clusterIP: 10.96.213.18
  19 │     clusterIPs:
  20 │         - 10.96.213.18
  21 │     internalTrafficPolicy: Local
  22 │     ipFamilies:
  23 │         - IPv4
  24 │     ipFamilyPolicy: SingleStack
  25 │     ports:
  26 └         - name: peer-service
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: hubble-relay (kubernetes)
==========================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'hubble-relay' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: hubble-relay:18-32
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌     clusterIP: 10.96.239.173
  19 │     clusterIPs:
  20 │         - 10.96.239.173
  21 │     internalTrafficPolicy: Cluster
  22 │     ipFamilies:
  23 │         - IPv4
  24 │     ipFamilyPolicy: SingleStack
  25 │     ports:
  26 └         - port: 80
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: hubble-ui (kubernetes)
=======================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'hubble-ui' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: hubble-ui:18-33
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  18 ┌     clusterIP: 10.96.24.255
  19 │     clusterIPs:
  20 │         - 10.96.24.255
  21 │     internalTrafficPolicy: Cluster
  22 │     ipFamilies:
  23 │         - IPv4
  24 │     ipFamilyPolicy: SingleStack
  25 │     ports:
  26 └         - name: http
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: kube-dns (kubernetes)
======================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'kube-dns' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: kube-dns:17-40
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  17 ┌     clusterIP: 10.96.0.10
  18 │     clusterIPs:
  19 │         - 10.96.0.10
  20 │     internalTrafficPolicy: Cluster
  21 │     ipFamilies:
  22 │         - IPv4
  23 │     ipFamilyPolicy: SingleStack
  24 │     ports:
  25 └         - name: dns
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: tetragon (kubernetes)
======================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'tetragon' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: tetragon:19-38
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  19 ┌     clusterIP: 10.96.150.192
  20 │     clusterIPs:
  21 │         - 10.96.150.192
  22 │     internalTrafficPolicy: Cluster
  23 │     ipFamilies:
  24 │         - IPv4
  25 │     ipFamilyPolicy: SingleStack
  26 │     ports:
  27 └         - name: metrics
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, service: tetragon-operator-metrics (kubernetes)
=======================================================================
Tests: 61 (SUCCESSES: 60, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Service 'tetragon-operator-metrics' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, service: tetragon-operator-metrics:19-35
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  19 ┌     clusterIP: 10.96.56.223
  20 │     clusterIPs:
  21 │         - 10.96.56.223
  22 │     internalTrafficPolicy: Cluster
  23 │     ipFamilies:
  24 │         - IPv4
  25 │     ipFamilyPolicy: SingleStack
  26 │     ports:
  27 └         - name: metrics
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, daemonset: cilium (kubernetes)
======================================================
Tests: 182 (SUCCESSES: 69, FAILURES: 113, EXCEPTIONS: 0)
Failures: 113 (UNKNOWN: 0, LOW: 59, MEDIUM: 28, HIGH: 26, CRITICAL: 0)

MEDIUM: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'cilium-agent' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'config' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should specify an AppArmor profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.

See https://avd.aquasec.com/misconfig/ksv002
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should specify an AppArmor profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.

See https://avd.aquasec.com/misconfig/ksv002
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should specify an AppArmor profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.

See https://avd.aquasec.com/misconfig/ksv002
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should specify an AppArmor profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.

See https://avd.aquasec.com/misconfig/ksv002
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'clean-cilium-state' of DaemonSet 'cilium' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'mount-cgroup' of DaemonSet 'cilium' should not include 'SYS_ADMIN' in 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.

See https://avd.aquasec.com/misconfig/ksv005
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: DaemonSet 'cilium' should not set 'spec.template.spec.hostNetwork' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.

See https://avd.aquasec.com/misconfig/ksv009
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:20-488
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     revisionHistoryLimit: 10
  21 │     selector:
  22 │         matchLabels:
  23 │             k8s-app: cilium
  24 │     template:
  25 │         metadata:
  26 │             annotations:
  27 │                 cilium.io/cilium-configmap-checksum: be807b5457223052d9e69a28bd28dc0cdec9d86668a82d011167d4455f6042b2
  28 └                 container.apparmor.security.beta.kubernetes.io/apply-sysctl-overwrites: unconfined
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'cilium-agent' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'config' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'config' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.privileged' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.

See https://avd.aquasec.com/misconfig/ksv017
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'cilium-agent' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'clean-cilium-state' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'config' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'install-cni-binaries' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-bpf-fs' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'mount-cgroup' of DaemonSet 'cilium' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'apply-sysctl-overwrites' of DaemonSet 'cilium' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'cilium-agent' of DaemonSet 'cilium' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'clean-cilium-state' of DaemonSet 'cilium' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'mount-cgroup' of DaemonSet 'cilium' should not set 'securityContext.capabilities.add'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.

See https://avd.aquasec.com/misconfig/ksv022
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'cilium' should not set 'spec.template.volumes.hostPath'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.

See https://avd.aquasec.com/misconfig/ksv023
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:20-488
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     revisionHistoryLimit: 10
  21 │     selector:
  22 │         matchLabels:
  23 │             k8s-app: cilium
  24 │     template:
  25 │         metadata:
  26 │             annotations:
  27 │                 cilium.io/cilium-configmap-checksum: be807b5457223052d9e69a28bd28dc0cdec9d86668a82d011167d4455f6042b2
  28 └                 container.apparmor.security.beta.kubernetes.io/apply-sysctl-overwrites: unconfined
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'cilium-agent' of DaemonSet 'cilium' should not set host ports, 'ports[*].hostPort'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.

See https://avd.aquasec.com/misconfig/ksv024
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'cilium' uses invalid seLinux type 'spc_t'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'SElinux', setting custom SELinux options should be disallowed.

See https://avd.aquasec.com/misconfig/ksv025
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:20-488
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     revisionHistoryLimit: 10
  21 │     selector:
  22 │         matchLabels:
  23 │             k8s-app: cilium
  24 │     template:
  25 │         metadata:
  26 │             annotations:
  27 │                 cilium.io/cilium-configmap-checksum: be807b5457223052d9e69a28bd28dc0cdec9d86668a82d011167d4455f6042b2
  28 └                 container.apparmor.security.beta.kubernetes.io/apply-sysctl-overwrites: unconfined
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:378-398
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 378 ┌                 - command:
 379 │                     - /install-plugin.sh
 380 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 381 │                   imagePullPolicy: IfNotPresent
 382 │                   name: install-cni-binaries
 383 │                   resources:
 384 │                     requests:
 385 │                         cpu: 100m
 386 └                         memory: 10Mi
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:277-308
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 277 ┌                 - command:
 278 │                     - sh
 279 │                     - -ec
 280 │                     - |
 281 │                       cp /usr/bin/cilium-sysctlfix /hostbin/cilium-sysctlfix;
 282 │                       nsenter --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-sysctlfix";
 283 │                       rm /hostbin/cilium-sysctlfix
 284 │                   env:
 285 └                     - name: BIN_PATH
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:243-276
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 243 ┌                 - command:
 244 │                     - sh
 245 │                     - -ec
 246 │                     - |
 247 │                       cp /usr/bin/cilium-mount /hostbin/cilium-mount;
 248 │                       nsenter --cgroup=/hostproc/1/ns/cgroup --mount=/hostproc/1/ns/mnt "${BIN_PATH}/cilium-mount" $CGROUP_ROOT;
 249 │                       rm /hostbin/cilium-mount
 250 │                   env:
 251 └                     - name: CGROUP_ROOT
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: DaemonSet 'cilium' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:20-488
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     revisionHistoryLimit: 10
  21 │     selector:
  22 │         matchLabels:
  23 │             k8s-app: cilium
  24 │     template:
  25 │         metadata:
  26 │             annotations:
  27 │                 cilium.io/cilium-configmap-checksum: be807b5457223052d9e69a28bd28dc0cdec9d86668a82d011167d4455f6042b2
  28 └                 container.apparmor.security.beta.kubernetes.io/apply-sysctl-overwrites: unconfined
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "apply-sysctl-overwrites" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "cilium-agent" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "clean-cilium-state" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "config" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "install-cni-binaries" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "mount-bpf-fs" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "mount-cgroup" of daemonset "cilium" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:309-326
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 309 ┌                 - args:
 310 │                     - mount | grep "/sys/fs/bpf type bpf" || mount -t bpf bpf /sys/fs/bpf
 311 │                   command:
 312 │                     - /bin/bash
 313 │                     - -c
 314 │                     - --
 315 │                   image: quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426
 316 │                   imagePullPolicy: IfNotPresent
 317 └                   name: mount-bpf-fs
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:216-242
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 216 ┌                 - command:
 217 │                     - cilium-dbg
 218 │                     - build-config
 219 │                   env:
 220 │                     - name: K8S_NODE_NAME
 221 │                       valueFrom:
 222 │                         fieldRef:
 223 │                             apiVersion: v1
 224 └                             fieldPath: spec.nodeName
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should not add stuff
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:261-266
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 261 ┌                         add:
 262 │                             - SYS_ADMIN
 263 │                             - SYS_CHROOT
 264 │                             - SYS_PTRACE
 265 │                         drop:
 266 └                             - ALL
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should not add stuff
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:293-298
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 293 ┌                         add:
 294 │                             - SYS_ADMIN
 295 │                             - SYS_CHROOT
 296 │                             - SYS_PTRACE
 297 │                         drop:
 298 └                             - ALL
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should not add stuff
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:154-168
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 154 ┌                         add:
 155 │                             - CHOWN
 156 │                             - KILL
 157 │                             - NET_ADMIN
 158 │                             - NET_RAW
 159 │                             - IPC_LOCK
 160 │                             - SYS_MODULE
 161 │                             - SYS_ADMIN
 162 └                             - SYS_RESOURCE
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should not add stuff
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:358-364
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 358 ┌                         add:
 359 │                             - NET_ADMIN
 360 │                             - SYS_MODULE
 361 │                             - SYS_ADMIN
 362 │                             - SYS_RESOURCE
 363 │                         drop:
 364 └                             - ALL
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container cilium-agent of daemonset cilium in kube-system namespace should not include 'NET_RAW' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv119
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container {"__defsec_metadata": {"endline": 212, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 49}, "args": ["--config-dir=/tmp/cilium/config-map"], "command": ["cilium-agent"], "env": [{"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 54}, "name": "K8S_NODE_NAME", "valueFrom": {"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 56}, "fieldRef": {"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 57}, "apiVersion": "v1", "fieldPath": "spec.nodeName"}}}, {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 59}, "name": "CILIUM_K8S_NAMESPACE", "valueFrom": {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 61}, "fieldRef": {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 62}, "apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"__defsec_metadata": {"endline": 65, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 64}, "name": "CILIUM_CLUSTERMESH_CONFIG", "value": "/var/lib/cilium/clustermesh/"}, {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 66}, "name": "GOMEMLIMIT", "valueFrom": {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 68}, "resourceFieldRef": {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 69}, "divisor": "1", "resource": "limits.memory"}}}, {"__defsec_metadata": {"endline": 72, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 71}, "name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"__defsec_metadata": {"endline": 74, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 73}, "name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "image": "quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426", "imagePullPolicy": "IfNotPresent", "lifecycle": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 78}, "postStart": {"__defsec_metadata": {"endline": 83, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 79}, "exec": {"__defsec_metadata": {"endline": 83, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 80}, "command": ["bash", "-c", "set -o errexit\nset -o pipefail\nset -o nounset\n\n# When running in AWS ENI mode, it's likely that 'aws-node' has\n# had a chance to install SNAT iptables rules. These can result\n# in dropped traffic, so we should attempt to remove them.\n# We do it using a 'postStart' hook since this may need to run\n# for nodes which might have already been init'ed but may still\n# have dangling rules. This is safe because there are no\n# dependencies on anything that is part of the startup script\n# itself, and can be safely run multiple times per node (e.g. in\n# case of a restart).\nif [[ \"$(iptables-save | grep -E -c 'AWS-SNAT-CHAIN|AWS-CONNMARK-CHAIN')\" != \"0\" ]];\nthen\n    echo 'Deleting iptables rules created by the AWS CNI VPC plugin'\n    iptables-save | grep -E -v 'AWS-SNAT-CHAIN|AWS-CONNMARK-CHAIN' | iptables-restore\nfi\necho 'Done!'\n"]}}, "preStop": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 104}, "exec": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 105}, "command": ["/cni-uninstall.sh"]}}}, "livenessProbe": {"__defsec_metadata": {"endline": 119, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 108}, "failureThreshold": 10, "httpGet": {"__defsec_metadata": {"endline": 116, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 110}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 113, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 112}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "periodSeconds": 30, "successThreshold": 1, "timeoutSeconds": 5}, "name": "cilium-agent", "ports": [{"__defsec_metadata": {"endline": 125, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 122}, "containerPort": 4244, "hostPort": 4244, "name": "peer-service", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 129, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 126}, "containerPort": 9962, "hostPort": 9962, "name": "prometheus", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 133, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 130}, "containerPort": 9964, "hostPort": 9964, "name": "envoy-metrics", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 137, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 134}, "containerPort": 9965, "hostPort": 9965, "name": "hubble-metrics", "protocol": "TCP"}], "readinessProbe": {"__defsec_metadata": {"endline": 150, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 139}, "failureThreshold": 3, "httpGet": {"__defsec_metadata": {"endline": 147, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 141}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 144, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 143}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "periodSeconds": 30, "successThreshold": 1, "timeoutSeconds": 5}, "resources": {"__defsec_metadata": {"endline": 151, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 151}}, "securityContext": {"__defsec_metadata": {"endline": 171, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 153}, "capabilities": {"__defsec_metadata": {"endline": 168, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 154}, "add": ["CHOWN", "KILL", "NET_ADMIN", "NET_RAW", "IPC_LOCK", "SYS_MODULE", "SYS_ADMIN", "SYS_RESOURCE", "DAC_OVERRIDE", "FOWNER", "SETGID", "SETUID"], "drop": ["ALL"]}, "seLinuxOptions": {"__defsec_metadata": {"endline": 171, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 170}, "level": "s0", "type": "spc_t"}}, "startupProbe": {"__defsec_metadata": {"endline": 185, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 173}, "failureThreshold": 105, "httpGet": {"__defsec_metadata": {"endline": 181, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 175}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 178, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 177}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "initialDelaySeconds": 5, "periodSeconds": 2, "successThreshold": 1, "timeoutSeconds": 1}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "FallbackToLogsOnError", "volumeMounts": [{"__defsec_metadata": {"endline": 190, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 189}, "mountPath": "/host/proc/sys/net", "name": "host-proc-sys-net"}, {"__defsec_metadata": {"endline": 192, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 191}, "mountPath": "/host/proc/sys/kernel", "name": "host-proc-sys-kernel"}, {"__defsec_metadata": {"endline": 195, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 193}, "mountPath": "/sys/fs/bpf", "mountPropagation": "HostToContainer", "name": "bpf-maps"}, {"__defsec_metadata": {"endline": 197, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 196}, "mountPath": "/var/run/cilium", "name": "cilium-run"}, {"__defsec_metadata": {"endline": 199, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 198}, "mountPath": "/host/etc/cni/net.d", "name": "etc-cni-netd"}, {"__defsec_metadata": {"endline": 202, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 200}, "mountPath": "/var/lib/cilium/clustermesh", "name": "clustermesh-secrets", "readOnly": true}, {"__defsec_metadata": {"endline": 205, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 203}, "mountPath": "/lib/modules", "name": "lib-modules", "readOnly": true}, {"__defsec_metadata": {"endline": 207, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 206}, "mountPath": "/run/xtables.lock", "name": "xtables-lock"}, {"__defsec_metadata": {"endline": 210, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 208}, "mountPath": "/var/lib/cilium/tls/hubble", "name": "hubble-tls", "readOnly": true}, {"__defsec_metadata": {"endline": 212, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 211}, "mountPath": "/tmp", "name": "tmp"}]} of daemonset cilium in kube-system namespace should not include 'SYS_MODULE' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv120
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container {"__defsec_metadata": {"endline": 212, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 49}, "args": ["--config-dir=/tmp/cilium/config-map"], "command": ["cilium-agent"], "env": [{"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 54}, "name": "K8S_NODE_NAME", "valueFrom": {"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 56}, "fieldRef": {"__defsec_metadata": {"endline": 58, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 57}, "apiVersion": "v1", "fieldPath": "spec.nodeName"}}}, {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 59}, "name": "CILIUM_K8S_NAMESPACE", "valueFrom": {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 61}, "fieldRef": {"__defsec_metadata": {"endline": 63, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 62}, "apiVersion": "v1", "fieldPath": "metadata.namespace"}}}, {"__defsec_metadata": {"endline": 65, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 64}, "name": "CILIUM_CLUSTERMESH_CONFIG", "value": "/var/lib/cilium/clustermesh/"}, {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 66}, "name": "GOMEMLIMIT", "valueFrom": {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 68}, "resourceFieldRef": {"__defsec_metadata": {"endline": 70, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 69}, "divisor": "1", "resource": "limits.memory"}}}, {"__defsec_metadata": {"endline": 72, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 71}, "name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"__defsec_metadata": {"endline": 74, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 73}, "name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "image": "quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426", "imagePullPolicy": "IfNotPresent", "lifecycle": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 78}, "postStart": {"__defsec_metadata": {"endline": 83, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 79}, "exec": {"__defsec_metadata": {"endline": 83, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 80}, "command": ["bash", "-c", "set -o errexit\nset -o pipefail\nset -o nounset\n\n# When running in AWS ENI mode, it's likely that 'aws-node' has\n# had a chance to install SNAT iptables rules. These can result\n# in dropped traffic, so we should attempt to remove them.\n# We do it using a 'postStart' hook since this may need to run\n# for nodes which might have already been init'ed but may still\n# have dangling rules. This is safe because there are no\n# dependencies on anything that is part of the startup script\n# itself, and can be safely run multiple times per node (e.g. in\n# case of a restart).\nif [[ \"$(iptables-save | grep -E -c 'AWS-SNAT-CHAIN|AWS-CONNMARK-CHAIN')\" != \"0\" ]];\nthen\n    echo 'Deleting iptables rules created by the AWS CNI VPC plugin'\n    iptables-save | grep -E -v 'AWS-SNAT-CHAIN|AWS-CONNMARK-CHAIN' | iptables-restore\nfi\necho 'Done!'\n"]}}, "preStop": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 104}, "exec": {"__defsec_metadata": {"endline": 106, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 105}, "command": ["/cni-uninstall.sh"]}}}, "livenessProbe": {"__defsec_metadata": {"endline": 119, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 108}, "failureThreshold": 10, "httpGet": {"__defsec_metadata": {"endline": 116, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 110}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 113, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 112}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "periodSeconds": 30, "successThreshold": 1, "timeoutSeconds": 5}, "name": "cilium-agent", "ports": [{"__defsec_metadata": {"endline": 125, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 122}, "containerPort": 4244, "hostPort": 4244, "name": "peer-service", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 129, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 126}, "containerPort": 9962, "hostPort": 9962, "name": "prometheus", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 133, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 130}, "containerPort": 9964, "hostPort": 9964, "name": "envoy-metrics", "protocol": "TCP"}, {"__defsec_metadata": {"endline": 137, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 134}, "containerPort": 9965, "hostPort": 9965, "name": "hubble-metrics", "protocol": "TCP"}], "readinessProbe": {"__defsec_metadata": {"endline": 150, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 139}, "failureThreshold": 3, "httpGet": {"__defsec_metadata": {"endline": 147, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 141}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 144, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 143}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "periodSeconds": 30, "successThreshold": 1, "timeoutSeconds": 5}, "resources": {"__defsec_metadata": {"endline": 151, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 151}}, "securityContext": {"__defsec_metadata": {"endline": 171, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 153}, "capabilities": {"__defsec_metadata": {"endline": 168, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 154}, "add": ["CHOWN", "KILL", "NET_ADMIN", "NET_RAW", "IPC_LOCK", "SYS_MODULE", "SYS_ADMIN", "SYS_RESOURCE", "DAC_OVERRIDE", "FOWNER", "SETGID", "SETUID"], "drop": ["ALL"]}, "seLinuxOptions": {"__defsec_metadata": {"endline": 171, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 170}, "level": "s0", "type": "spc_t"}}, "startupProbe": {"__defsec_metadata": {"endline": 185, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 173}, "failureThreshold": 105, "httpGet": {"__defsec_metadata": {"endline": 181, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 175}, "host": "127.0.0.1", "httpHeaders": [{"__defsec_metadata": {"endline": 178, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 177}, "name": "brief", "value": "true"}], "path": "/healthz", "port": 9879, "scheme": "HTTP"}, "initialDelaySeconds": 5, "periodSeconds": 2, "successThreshold": 1, "timeoutSeconds": 1}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "FallbackToLogsOnError", "volumeMounts": [{"__defsec_metadata": {"endline": 190, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 189}, "mountPath": "/host/proc/sys/net", "name": "host-proc-sys-net"}, {"__defsec_metadata": {"endline": 192, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 191}, "mountPath": "/host/proc/sys/kernel", "name": "host-proc-sys-kernel"}, {"__defsec_metadata": {"endline": 195, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 193}, "mountPath": "/sys/fs/bpf", "mountPropagation": "HostToContainer", "name": "bpf-maps"}, {"__defsec_metadata": {"endline": 197, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 196}, "mountPath": "/var/run/cilium", "name": "cilium-run"}, {"__defsec_metadata": {"endline": 199, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 198}, "mountPath": "/host/etc/cni/net.d", "name": "etc-cni-netd"}, {"__defsec_metadata": {"endline": 202, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 200}, "mountPath": "/var/lib/cilium/clustermesh", "name": "clustermesh-secrets", "readOnly": true}, {"__defsec_metadata": {"endline": 205, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 203}, "mountPath": "/lib/modules", "name": "lib-modules", "readOnly": true}, {"__defsec_metadata": {"endline": 207, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 206}, "mountPath": "/run/xtables.lock", "name": "xtables-lock"}, {"__defsec_metadata": {"endline": 210, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 208}, "mountPath": "/var/lib/cilium/tls/hubble", "name": "hubble-tls", "readOnly": true}, {"__defsec_metadata": {"endline": 212, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 211}, "mountPath": "/tmp", "name": "tmp"}]} of daemonset cilium in kube-system namespace should not include 'SYS_MODULE' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv120
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container {"__defsec_metadata": {"endline": 377, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 327}, "command": ["/init-container.sh"], "env": [{"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 330}, "name": "CILIUM_ALL_STATE", "valueFrom": {"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 332}, "configMapKeyRef": {"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 333}, "key": "clean-cilium-state", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 336}, "name": "CILIUM_BPF_STATE", "valueFrom": {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 338}, "configMapKeyRef": {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 339}, "key": "clean-cilium-bpf-state", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 342}, "name": "WRITE_CNI_CONF_WHEN_READY", "valueFrom": {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 344}, "configMapKeyRef": {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 345}, "key": "write-cni-conf-when-ready", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 349, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 348}, "name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"__defsec_metadata": {"endline": 351, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 350}, "name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "image": "quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426", "imagePullPolicy": "IfNotPresent", "name": "clean-cilium-state", "resources": {"__defsec_metadata": {"endline": 355, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 355}}, "securityContext": {"__defsec_metadata": {"endline": 367, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 357}, "capabilities": {"__defsec_metadata": {"endline": 364, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 358}, "add": ["NET_ADMIN", "SYS_MODULE", "SYS_ADMIN", "SYS_RESOURCE"], "drop": ["ALL"]}, "seLinuxOptions": {"__defsec_metadata": {"endline": 367, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 366}, "level": "s0", "type": "spc_t"}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "FallbackToLogsOnError", "volumeMounts": [{"__defsec_metadata": {"endline": 372, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 371}, "mountPath": "/sys/fs/bpf", "name": "bpf-maps"}, {"__defsec_metadata": {"endline": 375, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 373}, "mountPath": "/run/cilium/cgroupv2", "mountPropagation": "HostToContainer", "name": "cilium-cgroup"}, {"__defsec_metadata": {"endline": 377, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 376}, "mountPath": "/var/run/cilium", "name": "cilium-run"}]} of daemonset cilium in kube-system namespace should not include 'SYS_MODULE' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv120
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:327-377
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 327 ┌                 - command:
 328 │                     - /init-container.sh
 329 │                   env:
 330 │                     - name: CILIUM_ALL_STATE
 331 │                       valueFrom:
 332 │                         configMapKeyRef:
 333 │                             key: clean-cilium-state
 334 │                             name: cilium-config
 335 └                             optional: true
 ...   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: container {"__defsec_metadata": {"endline": 377, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 327}, "command": ["/init-container.sh"], "env": [{"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 330}, "name": "CILIUM_ALL_STATE", "valueFrom": {"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 332}, "configMapKeyRef": {"__defsec_metadata": {"endline": 335, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 333}, "key": "clean-cilium-state", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 336}, "name": "CILIUM_BPF_STATE", "valueFrom": {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 338}, "configMapKeyRef": {"__defsec_metadata": {"endline": 341, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 339}, "key": "clean-cilium-bpf-state", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 342}, "name": "WRITE_CNI_CONF_WHEN_READY", "valueFrom": {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 344}, "configMapKeyRef": {"__defsec_metadata": {"endline": 347, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 345}, "key": "write-cni-conf-when-ready", "name": "cilium-config", "optional": true}}}, {"__defsec_metadata": {"endline": 349, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 348}, "name": "KUBERNETES_SERVICE_HOST", "value": "kind-control-plane"}, {"__defsec_metadata": {"endline": 351, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 350}, "name": "KUBERNETES_SERVICE_PORT", "value": "6443"}], "image": "quay.io/cilium/cilium:v1.15.4@sha256:b760a4831f5aab71c711f7537a107b751d0d0ce90dd32d8b358df3c5da385426", "imagePullPolicy": "IfNotPresent", "name": "clean-cilium-state", "resources": {"__defsec_metadata": {"endline": 355, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 355}}, "securityContext": {"__defsec_metadata": {"endline": 367, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 357}, "capabilities": {"__defsec_metadata": {"endline": 364, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 358}, "add": ["NET_ADMIN", "SYS_MODULE", "SYS_ADMIN", "SYS_RESOURCE"], "drop": ["ALL"]}, "seLinuxOptions": {"__defsec_metadata": {"endline": 367, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 366}, "level": "s0", "type": "spc_t"}}, "terminationMessagePath": "/dev/termination-log", "terminationMessagePolicy": "FallbackToLogsOnError", "volumeMounts": [{"__defsec_metadata": {"endline": 372, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 371}, "mountPath": "/sys/fs/bpf", "name": "bpf-maps"}, {"__defsec_metadata": {"endline": 375, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 373}, "mountPath": "/run/cilium/cgroupv2", "mountPropagation": "HostToContainer", "name": "cilium-cgroup"}, {"__defsec_metadata": {"endline": 377, "filepath": "kube-system-DaemonSet-cilium-320372340.yaml", "offset": 0, "startline": 376}, "mountPath": "/var/run/cilium", "name": "cilium-run"}]} of daemonset cilium in kube-system namespace should not include 'SYS_MODULE' in securityContext.capabilities.add
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.

See https://avd.aquasec.com/misconfig/ksv120
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:49-212
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  49 ┌                 - args:
  50 │                     - --config-dir=/tmp/cilium/config-map
  51 │                   command:
  52 │                     - cilium-agent
  53 │                   env:
  54 │                     - name: K8S_NODE_NAME
  55 │                       valueFrom:
  56 │                         fieldRef:
  57 └                             apiVersion: v1
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: daemonset cilium in kube-system namespace shouldn't have volumes set to {"/proc"}
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.

See https://avd.aquasec.com/misconfig/ksv121
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, daemonset: cilium:20-488
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     revisionHistoryLimit: 10
  21 │     selector:
  22 │         matchLabels:
  23 │             k8s-app: cilium
  24 │     template:
  25 │         metadata:
  26 │             annotations:
  27 │                 cilium.io/cilium-configmap-checksum: be807b5457223052d9e69a28bd28dc0cdec9d86668a82d011167d4455f6042b2
  28 └                 container.apparmor.security.beta.kubernetes.io/apply-sysctl-overwrites: unconfined
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, configmap: cilium-config (kubernetes)
=============================================================
Tests: 62 (SUCCESSES: 61, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: ConfigMap 'cilium-config' in 'kube-system' namespace stores sensitive contents in key(s) or value(s) '{"agent-not-ready-taint-key", "bpf-lb-map-max", "bpf-policy-map-max", "hubble-tls-key-file", "max-connected-clusters", "mesh-auth-queue-size", "mesh-auth-rotated-identities-queue-size", "proxy-prometheus-port", "tofqdns-max-deferred-connection-deletes"}'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, configmap: extension-apiserver-authentication (kubernetes)
==================================================================================
Tests: 62 (SUCCESSES: 61, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: ConfigMap 'extension-apiserver-authentication' in 'kube-system' namespace stores sensitive contents in key(s) or value(s) '{"requestheader-username-headers"}'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, configmap: hubble-relay-config (kubernetes)
===================================================================
Tests: 62 (SUCCESSES: 61, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: ConfigMap 'hubble-relay-config' in 'kube-system' namespace stores sensitive contents in key(s) or value(s) '{"config.yaml"}'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, configmap: tetragon-config (kubernetes)
===============================================================
Tests: 62 (SUCCESSES: 61, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: ConfigMap 'tetragon-config' in 'kube-system' namespace stores sensitive contents in key(s) or value(s) '{"export-file-perm", "process-cache-size"}'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Storing sensitive content such as usernames and email addresses in configMaps is unsafe

See https://avd.aquasec.com/misconfig/avd-ksv-01010
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, ingress: hubble-ingress (kubernetes)
============================================================
Tests: 60 (SUCCESSES: 59, FAILURES: 1, EXCEPTIONS: 0)
Failures: 1 (UNKNOWN: 0, LOW: 0, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

MEDIUM: Ingress 'hubble-ingress' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, ingress: hubble-ingress:8-18
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
   8 ┌     rules:
   9 │         - host: hubble.seccamp.com
  10 │           http:
  11 │             paths:
  12 │                 - backend:
  13 │                     service:
  14 │                         name: hubble-ui
  15 │                         port:
  16 └                             number: 80
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, deployment: hubble-ui (kubernetes)
==========================================================
Tests: 107 (SUCCESSES: 80, FAILURES: 27, EXCEPTIONS: 0)
Failures: 27 (UNKNOWN: 0, LOW: 18, MEDIUM: 7, HIGH: 2, CRITICAL: 0)

MEDIUM: Container 'backend' of Deployment 'hubble-ui' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'frontend' of Deployment 'hubble-ui' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should add 'ALL' to 'securityContext.capabilities.drop'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'backend' of Deployment 'hubble-ui' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Container 'frontend' of Deployment 'hubble-ui' should set 'securityContext.runAsNonRoot' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'backend' of Deployment 'hubble-ui' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'frontend' of Deployment 'hubble-ui' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'securityContext.runAsUser' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'backend' of Deployment 'hubble-ui' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'frontend' of Deployment 'hubble-ui' should set 'securityContext.runAsGroup' > 10000
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Deployment 'hubble-ui' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:20-107
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     progressDeadlineSeconds: 600
  21 │     replicas: 1
  22 │     revisionHistoryLimit: 10
  23 │     selector:
  24 │         matchLabels:
  25 │             k8s-app: hubble-ui
  26 │     strategy:
  27 │         rollingUpdate:
  28 └             maxSurge: 25%
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "backend" of deployment "hubble-ui" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "frontend" of deployment "hubble-ui" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:77-91
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  77 ┌                 - env:
  78 │                     - name: EVENTS_SERVER_PORT
  79 │                       value: "8090"
  80 │                     - name: FLOWS_API_ADDR
  81 │                       value: hubble-relay:80
  82 │                   image: quay.io/cilium/hubble-ui-backend:v0.13.0@sha256:1e7657d997c5a48253bb8dc91ecee75b63018d16ff5e5797e5af367336bc8803
  83 │                   imagePullPolicy: IfNotPresent
  84 │                   name: backend
  85 └                   ports:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: container should drop all
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-ui:43-76
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  43 ┌                 - image: quay.io/cilium/hubble-ui:v0.13.0@sha256:7d663dc16538dd6e29061abd1047013a645e6e69c115e008bee9ea9fef9a6666
  44 │                   imagePullPolicy: IfNotPresent
  45 │                   livenessProbe:
  46 │                     failureThreshold: 3
  47 │                     httpGet:
  48 │                         path: /healthz
  49 │                         port: 8081
  50 │                         scheme: HTTP
  51 └                     periodSeconds: 10
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: , node: kind-control-plane (kubernetes)
==================================================
Tests: 105 (SUCCESSES: 100, FAILURES: 5, EXCEPTIONS: 0)
Failures: 5 (UNKNOWN: 0, LOW: 1, MEDIUM: 0, HIGH: 3, CRITICAL: 1)

HIGH: Ensure that the Container Network Interface specification file permissions is set to 600 or more restrictive
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the container network interface file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0056
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Ensure that the etcd data directory ownership is set to etcd:etcd
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the etcd data directory ownership is set to etcd:etcd.

See https://avd.aquasec.com/misconfig/kcv0059
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Ensure that the kubelet service file permissions are set to 600 or more restrictive
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the kubelet service file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0069
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


CRITICAL: Ensure that the certificate authorities file permissions are set to 600 or more restrictive
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the certificate authorities file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0075
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0077
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: , node: kind-worker2 (kubernetes)
============================================
Tests: 105 (SUCCESSES: 103, FAILURES: 2, EXCEPTIONS: 0)
Failures: 2 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 2, CRITICAL: 0)

HIGH: Ensure that the kubelet service file permissions are set to 600 or more restrictive
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the kubelet service file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0069
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0077
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: , node: kind-worker (kubernetes)
===========================================
Tests: 105 (SUCCESSES: 103, FAILURES: 2, EXCEPTIONS: 0)
Failures: 2 (UNKNOWN: 0, LOW: 0, MEDIUM: 0, HIGH: 2, CRITICAL: 0)

HIGH: Ensure that the kubelet service file permissions are set to 600 or more restrictive
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that the kubelet service file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0069
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Ensure that if the kubelet refers to a configuration file with the --config argument, that file has permissions of 600 or more restrictive.

See https://avd.aquasec.com/misconfig/kcv0077
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────



namespace: kube-system, deployment: hubble-relay (kubernetes)
=============================================================
Tests: 94 (SUCCESSES: 85, FAILURES: 9, EXCEPTIONS: 0)
Failures: 9 (UNKNOWN: 0, LOW: 5, MEDIUM: 3, HIGH: 1, CRITICAL: 0)

MEDIUM: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'securityContext.allowPrivilegeEscalation' to false
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'resources.limits.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


HIGH: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'securityContext.readOnlyRootFilesystem' to true
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'resources.requests.cpu'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'resources.requests.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Container 'hubble-relay' of Deployment 'hubble-relay' should set 'resources.limits.memory'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:48-99
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  48 ┌                 - args:
  49 │                     - serve
  50 │                   command:
  51 │                     - hubble-relay
  52 │                   image: quay.io/cilium/hubble-relay:v1.15.4@sha256:03ad857feaf52f1b4774c29614f42a50b370680eb7d0bfbc1ae065df84b1070a
  53 │                   imagePullPolicy: IfNotPresent
  54 │                   livenessProbe:
  55 │                     failureThreshold: 3
  56 └                     grpc:
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: Deployment 'hubble-relay' should not be set with 'kube-system' namespace
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
ensure that User pods are not placed in kube-system namespace

See https://avd.aquasec.com/misconfig/ksv037
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
 namespace: kube-system, deployment: hubble-relay:20-130
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
  20 ┌     progressDeadlineSeconds: 600
  21 │     replicas: 1
  22 │     revisionHistoryLimit: 10
  23 │     selector:
  24 │         matchLabels:
  25 │             k8s-app: hubble-relay
  26 │     strategy:
  27 │         rollingUpdate:
  28 └             maxSurge: 25%
  ..   
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


MEDIUM: container "hubble-relay" of deployment "hubble-relay" in "kube-system" namespace should specify a seccomp profile
═════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────


